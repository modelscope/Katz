Using EulerDiscreteScheduler
In unet_2d_condition.py
Total GPUs in the world: 8
torch.distributed.is_available(): True
torch.distributed.is_nccl_available(): True
Args: Namespace(world_size=8, gpu_id=7, rank=7, dst_rank=1, controlnet_parallel_rank=[3, 5, 7], verbose=False)
World size: 8, rank: 7
Enable cuda graph: True
load_state_dict: safetensors.torch.load_file(/home/lyangbk/.cache/huggingface/hub/models--diffusers--controlnet-depth-sdxl-1.0/snapshots/17bb97973f29801224cd66f192c5ffacf82648b4/diffusion_pytorch_model.fp16.safetensors)
Start controlnet server on GPU 7
Avg: 0.5449, Sum: 27.2471
Avg: 0.0136, Sum: 0.6816
Avg: 0.0136, Sum: 0.6814
Avg: 0.0136, Sum: 0.6811
Avg: 0.0136, Sum: 0.6812
Avg: 0.0136, Sum: 0.6811
Avg: 0.0136, Sum: 0.6811
Avg: 0.0136, Sum: 0.6812
Avg: 0.0136, Sum: 0.6813
Avg: 0.0136, Sum: 0.6812
Avg: 0.0136, Sum: 0.6812
Avg: 0.0136, Sum: 0.6813
Avg: 0.0136, Sum: 0.6813
Avg: 0.0136, Sum: 0.6813
Avg: 0.0136, Sum: 0.6816
Avg: 0.0136, Sum: 0.6812
Avg: 0.0136, Sum: 0.6811
Avg: 0.0136, Sum: 0.6820
Avg: 0.0136, Sum: 0.6813
Avg: 0.0136, Sum: 0.6814
Avg: 0.0136, Sum: 0.6815
Avg: 0.0136, Sum: 0.6812
Avg: 0.0136, Sum: 0.6813
Avg: 0.0136, Sum: 0.6813
Avg: 0.0136, Sum: 0.6816
Avg: 0.0136, Sum: 0.6813
Avg: 0.0136, Sum: 0.6815
Avg: 0.0136, Sum: 0.6815
Avg: 0.0136, Sum: 0.6814
Avg: 0.0136, Sum: 0.6816
Avg: 0.0136, Sum: 0.6815
