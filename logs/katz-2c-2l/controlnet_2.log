Using EulerDiscreteScheduler
In unet_2d_condition.py
Total GPUs in the world: 8
torch.distributed.is_available(): True
torch.distributed.is_nccl_available(): True
Args: Namespace(world_size=6, gpu_id=2, rank=2, dst_rank=0, controlnet_parallel_rank=[2, 4], verbose=False)
World size: 6, rank: 2
Enable cuda graph: True
load_state_dict: safetensors.torch.load_file(/home/lyangbk/.cache/huggingface/hub/models--diffusers--controlnet-depth-sdxl-1.0/snapshots/17bb97973f29801224cd66f192c5ffacf82648b4/diffusion_pytorch_model.fp16.safetensors)
Start controlnet server on GPU 2
Avg: 0.5463, Sum: 27.3132
Avg: 0.0137, Sum: 0.6850
Avg: 0.0137, Sum: 0.6837
Avg: 0.0137, Sum: 0.6837
Avg: 0.0137, Sum: 0.6831
Avg: 0.0137, Sum: 0.6834
Avg: 0.0137, Sum: 0.6828
Avg: 0.0137, Sum: 0.6839
Avg: 0.0137, Sum: 0.6832
Avg: 0.0137, Sum: 0.6833
Avg: 0.0137, Sum: 0.6834
Avg: 0.0137, Sum: 0.6837
Avg: 0.0137, Sum: 0.6838
Avg: 0.0137, Sum: 0.6837
Avg: 0.0137, Sum: 0.6835
Avg: 0.0137, Sum: 0.6834
Avg: 0.0137, Sum: 0.6831
Avg: 0.0137, Sum: 0.6833
Avg: 0.0137, Sum: 0.6833
Avg: 0.0137, Sum: 0.6836
Avg: 0.0137, Sum: 0.6838
Avg: 0.0137, Sum: 0.6837
Avg: 0.0137, Sum: 0.6839
Avg: 0.0137, Sum: 0.6829
Avg: 0.0137, Sum: 0.6838
Avg: 0.0137, Sum: 0.6827
Avg: 0.0137, Sum: 0.6825
Avg: 0.0137, Sum: 0.6829
Avg: 0.0137, Sum: 0.6830
Avg: 0.0137, Sum: 0.6829
Avg: 0.0137, Sum: 0.6833
